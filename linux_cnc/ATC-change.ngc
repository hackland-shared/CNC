
# Tool change .ngc for Jianken ATC to run in linuxCNC
# written: C. Stewrt November 2021
# cstewart000@gmail.com


# References: http://www.jinlantrade.com/ebay/invertermanual.pdf
https://github.com/peterdownunder/mechmate


### Hardware definitions.

# Outputs
# M62 P0 - Tool clutch - air inlet/air return
# M62 P1 - Purge air - dust removal (internal rotor)
# M62 P2 - air sealed - to clean dust and chips off external spindle w. way
# M62 P3 - Spare


# INPUTS

# Thermistor 103F3950 R25:10K 1% B 3950K

# Tool holder in position brown 10-30VDC - black wire signal??


# Variables
	# x_y_safe_jog_speed 200
	# z_safe_jog_speed 100
	# x_y_normal_jog_speed 500
	# z_normal_jog_speed 200

	# pocket_offset -50
	# clutch_time


M6 T6

# pre-check safety

	#Is Z-axis homed

	#spindle off?


# Is there a tool in the spindle?

	OR(
		# virtual pin?
		# Spindle output


	# yes, which tool?

		# return tool

	# no.


# return tool

	# move to tool pocket location -50mm Y.

	# Lower z axis to pocket height

	# Slow move to location

	# Clutch
		# control valve for tool release (for 3-5s)

		# control valve for dust removal 

	# Slow retract Z axis

	# move to tool pocket location -50mm Y.

	# Set virtual pin "no tool" 

# pickup tool

	# move to tool pocket location

	

	# Clutch
		# control valve for tool release (for 3-5s)

		# control valve for dust removal 


	# slow Lower z axis to pocket height

		# tun off air inlet and dust removal (same time)

		# air return (5s)

	# move to tool pocket location -50mm Y.

		



	# Slow retract Z axis

	# Set virtual pin "tool" 

